<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Insert title here</title>
	<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
	<script src="//code.jquery.com/jquery-1.12.0.min.js"></script>
	<script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
	<link href="./css/qna.css" rel="stylesheet">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>	
<script>
var contextPath = function getContextPath(){
    var offset=location.href.indexOf(location.host)+location.host.length;
    var ctxPath=location.href.substring(offset,location.href.indexOf('/',offset+1));
    return ctxPath;
}
$(".header").load(contextPath+"/header/header.html.header")
</script>

</head>
<body>
	<div id="wrap" class="qna">
		<div id="header" class="header"></div>
   	    <div id="sidebar"></div>
   		
   		<div class="qna_list" id="content">
   			<font color="#FE9A2E"><h3>Q&A</h3></font>
   			<div class="content_section"></div>
    		<div class="search_box">
     			<form id="searchForm" method="post">
     				<input type ="hidden" name="content_id" value="751">
       				<fieldset>
         				<legend class="blind">검색</legend>
         				<div class="box">
          					<label for>
          						<img src="./img/p.gif" alt="궁금한 점 검색으로 찾기">
       						</label>
	        				<select id="searchSelect">
	         					<option value="subject">제목</option>
	         					<option value="content">내용</option>
	         					<option value="name">작성자</option>
	         				</select>
	       					<input type="search" id="s_value" value title="검색어 입력" class ="input_txt">
	        				<input type="image" onclick="return check_search_form();" src="./img/search.gif" alt="search">
     					</div>
    				</fieldset>
    			</form>
    		</div>  
		    <table class="basic_table" id="basic_table">     
     		<tr height="40">
		        <td height="40"><img src="./img/bunho.gif"></td>  
		        <td height="40"><img src="./img/title.gif"></td>  
		        <td height="40"><img src="./img/nick.gif"></td>  
		        <td height="40"><img src="./img/searchsu.gif"></td>  
		        <td height="40"><img src="./img/day.gif"></td>  
		    </tr>
 			
			</table>
  			<br/>
 			<p align="right"><input class="btn btn-warning" type="button" value="글쓰기" onclick="document.location.href='qnaRegistForm.html'"></p>
     	</div>
	    <div id="righter">
    		<img src="./img/hair1.jpg" width="200px"></br>
    		<img src="./img/hair6.jpg" width="200px"></br>
   		</div>
	</div>
	<script>
		var contextRoot = 'http://localhost:8008/salon/';
		$.ajax(contextRoot + '/board/list.do', {
			dataType: 'json',
			method: 'GET',
			success: function(resultObj) {
				  var table = $("#basic_table");
				  //alert(resultObj);
				  for (var board of resultObj.data) {
				    $("<tr>")
				      .html("<td>" + board.qna_no + 
							      "</td><td><a class='detailLnk' href='#' boardNo='" 
					          + board.qna_no + "'>" + board.qna_title +  
							      "</a></td><td>"+board.nick+"</td><td>" + board.viewnum +
							      "</td><td>" + board.reg_Date + "</td>")
							.appendTo(table);
				    
				    $("a.detailLnk").click(clickDetailLnk);
				  }				
			},
			error: function(jqXHR, textStatus, errorThrown) {
				alert("오호라.. 오류다!");
				console.log(textStatus);
				console.log(errorThrown);
			}
		});
		
		function check_search_form() {
			var contextRoot = 'http://localhost:8008/salon/';
			$("#basic_table").remove();
			$.ajax(contextRoot + '/board/list.do?', {
				dataType: 'json',
				method: 'GET',
				success: function(resultObj) {
					  var table = $("#basic_table");
					  //alert(resultObj);
					  for (var board of resultObj.data) {
					    $("<tr>")
					      .html("<td>" + board.qna_no + 
								      "</td><td><a class='detailLnk' href='#' boardNo='" 
								          + board.qna_no + "'>" + board.qna_title + 
								      "</a></td><td>"+board.nick+"</td><td>" + board.viewnum +
								      "</td><td>" + board.reg_Date + "</td>")
								.appendTo(table);
					    $("a.detailLnk").click(clickDetailLnk);
					  }				
				},
				error: function(jqXHR, textStatus, errorThrown) {
					alert("오호라.. 오류다!");
					console.log(textStatus);
					console.log(errorThrown);
				}
			});
		}
		function clickDetailLnk(event) {
			event.preventDefault(); 
			location.href = "form.html?no=" + $(event.target).attr("boardNo");
		}
	</script> 
</body>
</html>